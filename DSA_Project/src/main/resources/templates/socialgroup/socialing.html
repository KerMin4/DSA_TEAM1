<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>그룹 목록 페이지</title>
    <script th:src="@{/js/jquery-3.7.1.min.js}"></script>
    <link th:href="@{/css/header.css}" rel="stylesheet">
    <link th:href="@{/css/sidebar.css}" rel="stylesheet">
    <link th:href="@{/css/socialing.css}" rel="stylesheet">
    <script th:src="@{/js/socialing.js}"></script>
</head>
<body>
    <th:block th:replace="fragments/header :: header"></th:block>

    <div class="container">
        <!-- Sidebar Section -->
        <div class="sidebar">
            <h2>검색어로 내게 맞는 그룹 찾기</h2>
            <div class="search">
                <!-- 검색 폼: 사용자가 검색어를 입력하고 검색 버튼을 누르면 서버로 요청이 전송됨 -->
                <form id="searchForm">
                    <input type="text" id="searchInput" name="query" placeholder="검색어를 입력하세요...">
                    <button type="submit" id="searchButton">검색</button>
                </form>
            </div>
            
            <br><br>

            <!-- 카테고리 필터 -->
            <div class="category-filters">
                <h3 id="category-toggle" style="cursor: pointer;">카테고리별</h3>
                <div id="category-container" style="display: none;">
                    <label><input type="radio" name="interest" value="취미"> 취미</label>
                    <label><input type="radio" name="interest" value="자기계발"> 자기계발</label>
                    <label><input type="radio" name="interest" value="푸드"> 푸드</label>
                    <label><input type="radio" name="interest" value="액티비티"> 액티비티</label>
                    <label><input type="radio" name="interest" value="반려동물"> 반려동물</label>
                    <label><input type="radio" name="interest" value="문화"> 문화</label>
                    <label><input type="radio" name="interest" value="재테크"> 재테크</label>
                    <label><input type="radio" name="interest" value="연애"> 연애</label>
                    <label><input type="radio" name="interest" value="게임"> 게임</label>
                    <label><input type="radio" name="interest" value="여행"> 여행</label>
                </div>
            </div>
            
            <!-- 지역별 필터 -->
            <div class="location-filters">
                <h3 id="location-toggle" style="cursor: pointer;">지역별</h3>
                <div id="location-container" class="hidden">
                    <!-- 상위 지역 버튼들이 여기에 동적으로 생성됨 -->
                    <div id="region-container" class="region-container"></div>
                </div>
            </div>

            <div class="sort-filters">
			    <h3 id="sort-toggle" style="cursor: pointer;">정렬 기준</h3>
			    <div id="sort-options" class="hidden">
			        <table>
			            <tr>
			                <td><input type="radio" class="sort-btn" name="sort" value="popular"> 인기 순 (북마크 많은 수)</td>
			            </tr>
			            <tr>
			                <td><input type="radio" class="sort-btn" name="sort" value="eventDate"> 이벤트 날짜 순</td>
			            </tr>
			            <tr>
			                <td><input type="radio" class="sort-btn" name="sort" value="latest"> 최신 순</td>
			            </tr>
			        </table>
			    </div>
			</div>
        </div>

        <!-- Main Content Section -->
        <div class="main-content">
        	<!-- Hashtag filter buttons -->
		    <div class="hashtags" id="hashtag-container">
		        <div>
		        	<!-- 해시태그가 없을 때 기본적으로 출력 -->
			        <div th:if="${#lists.isEmpty(allHashtags)}">
			            <span>#아직 등록된 해시태그가 없습니다. 해시태그를 추가해보세요.</span>
			        </div>
			        <!-- 해시태그가 있을 때 출력 -->
			        <div th:each="hashtag : ${allHashtags}">
			            <span th:text="${hashtag}"></span>
			        </div>
			    </div>
		    </div>

            <h2 th:if="${name != null}" th:text="'[[${name}]]님의 관심사에 맞는 그룹들을 만나보세요!'"></h2>
            <h2 th:if="${name == null}">로그인 후 관심사에 맞는 그룹들을 만나보세요!</h2>
            
            <!-- Group Listings -->
            <div class="group-listing" id="group-container">
                <!-- 전체 그룹 목록을 처음에 출력 -->
                <!-- 기본 메시지를 추가할 때만 보이도록 설정 -->
    			<p th:if="${#lists.isEmpty(groups)}">전체 그룹 목록을 확인하세요!</p>
                <div th:each="group : ${groups}">
                    <div class="group-card">
                        <div class="group-info">
                            <table>
                                <tr>
                                    <td><img th:src="@{${group.profileImage}}" alt="그룹 사진" class="group-image"></td>
                                    <td>
                                        <h3 th:text="${group.groupName}">그룹 이름</h3>
                                        <p th:text="'위치: ' + ${group.location}">위치</p>
                                        <p th:text="'날짜: ' + ${#dates.format(group.eventDate, 'MM.dd(EEE) HH:mm')}">날짜</p>
                                        <p th:text="'인원: ' + ${group.memberCount} + '/' + ${group.memberLimit} + '명'">인원</p>
                                    </td>
                                    <td>
                                        <a th:href="@{/socialgroup/board(groupId=${group.groupId})}" class="join-btn">그룹 참여</a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                
	                <!-- 검색 결과가 없을 때 출력할 메시지 -->
				<div id="no-result-message" style="display: none;">
	                <p id="no-result-text"></p>
	            </div>
            </div>
            <a th:href="@{/socialgroup/create}" class="btn create-btn">그룹 생성</a>
		</div>
	</div>
</body>
</html>
