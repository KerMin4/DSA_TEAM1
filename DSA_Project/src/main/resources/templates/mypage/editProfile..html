<!DOCTYPE html>
<html xmlns:th="thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>프로필 수정</title>
    <script th:src="/js/jquery-3.7.1.min.js"></script>
    <script>
        $(document).ready(function(){
            var formData = new FormData();
            $('#nextStep1').click(function(){
                var selectedInterests = [];
                $('input[name="interests"]:checked').each(function(){
                    selectedInterests.push($(this).val());
                });
                
                if(selectedInterests.length > 0){
                    formData.append('interests', selectedInterests);
                    $('#step1').removeClass('active');
                    $('#step2').addClass('active');
                } else {
                    alert("최소한 하나의 취향을 선택해 주세요.");
                }
                
                if(selectedInterests.length > 5){
                    alert("취향은 다섯 개까지 선택 가능해요.");
                    selectedInterests = [];
                    return;
                }
            });
            
            $('#nextStep2').click(function(){
                var location = $('#location').val();
                if(location){
                    formData.append('location', location);
                    $('#step2').removeClass('active');
                    $('#step3').addClass('active');
                } else{
                    alert("관심 지역을 선택해 주세요.");
                }
            });
            
            // ui할때 카메라 아이콘 넣어야댐
            $('#cameraIcon').click(function(){
                $('#profileImage').click(); 
            });

            $('#profileImage').change(function(){
                var fileName = $(this).val().split('\\').pop(); 
                $('#fileNameDisplay').text(fileName);
            });

            $('#submitForm').click(function(){
                var phone = $('#phone').val();
                var email = $('#email').val();
                var profileImage = $('#profileImage')[0].files[0];
                
                if(!phone || !email || !profileImage){
                    alert("모든 정보를 입력해 주세요.");
                    return;
                }
                
                formData.append('phone', phone);
                formData.append('email', email);
                formData.append('profileImage', profileImage);
              
                $('#form-step3').submit();
            });
        });
    </script>
</head>
<body>
    <div class="step active" id="step1">
        <h2>취향을 업데이트하세요!</h2>
        <p style="color: gray;">(관심사는 최대 5개까지 선택 가능해요.)</p>
        <form id="form-step1">
            <input type="checkbox" name="interests" value="취미"> 취미<br>
            <input type="checkbox" name="interests" value="자기계발"> 자기계발<br>
            <input type="checkbox" name="interests" value="푸드"> 푸드<br>
            <input type="checkbox" name="interests" value="액티비티"> 액티비티<br>
            <input type="checkbox" name="interests" value="반려동물"> 반려동물<br>
            <input type="checkbox" name="interests" value="문화"> 문화<br>
            <input type="checkbox" name="interests" value="재테크"> 재테크<br>
            <input type="checkbox" name="interests" value="연애"> 연애<br>
            <input type="checkbox" name="interests" value="게임"> 게임<br>
            <input type="checkbox" name="interests" value="여행"> 여행<br>
            <button type="button" id="nextStep1">다음 페이지</button>
        </form>
    </div>

    <div class="step" id="step2">
        <h2>관심 지역을 설정하세요!</h2>
        <form id="form-step2">
            <input type="text" id="location" name="location" placeholder="관심 지역 입력"><br>
            <button type="button" id="nextStep2">다음 페이지</button>
        </form>
    </div>

    <div class="step" id="step3">
        <h2>이제 거의 다 왔어요!</h2>
        <form id="form-step3" action="/upload" method="post" enctype="multipart/form-data">
            <input type="text" id="phone" name="phone" placeholder="휴대전화"><br>
            <input type="email" id="email" name="email" placeholder="이메일"><br>
            <div>
                <img id="cameraIcon" src="camera_icon.png" alt="카메라" style="cursor:pointer; width: 50px; height: 50px;"> <!-- 카메라 아이콘 -->
                <input type="file" id="profileImage" name="profileImage" accept="image/*" style="display:none;"> <!-- 숨겨진 파일 입력 -->
                <span id="fileNameDisplay">파일을 선택하세요.</span> 
            </div>
            <button type="button" id="submitForm">수정하기</button>
        </form>
    </div>
</body>
</html>
